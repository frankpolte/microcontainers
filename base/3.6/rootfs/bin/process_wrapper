#!/bin/sh
# Generic process wrapper script
#
# https://mmonit.com/wiki/Monit/FAQ
# https://stackoverflow.com/questions/23454344/use-monit-monitor-a-python-program
#
# (c) 2017 Martin Haso≈à <martin.hason@gmail.com>

_action=$1
_name=$2
shift
shift

case $_action in
    start)
        /sbin/tini -s -g -- "$@" &
        echo $! > "/var/run/$_name.pid";
        ;;
    stop)
        kill $(cat "/var/run/$_name.pid")
        rm -f "/var/run/$_name.pid"
        ;;
    *)
        echo "usage: process_wrapper {start|stop} name [command]" ;;
esac
exit 0
